import{a as x,q as G,r as P,C as z,p as A,s as H,G as Z}from"./element-plus@2.9.10_vue@3.5.14-e58ff881.js";import{_ as J}from"./index-17e7a6f7.js";import{_ as K}from"./index-e4ea1e4c.js";import{_ as Q}from"./index-f854da1e.js";import{s as c}from"./index-6f2da097.js";import{$ as W}from"./_t-d5227884.js";import{q as X,D as Y,b as y,y as o,a as ee}from"./@vue_reactivity@3.5.14-2213b677.js";import{o as h,H as F,I as i,a as te,i as l,M as C,L as ae,n as V}from"./@vue_runtime-core@3.5.14-81aa8ddd.js";import{U as I}from"./@vue_shared@3.5.14-94c2c668.js";function _e(d){return c({url:"/mall4cloud_product/platform/brand/page",method:"get",params:d})}function re(d){return c({url:"/mall4cloud_product/platform/brand",method:"get",params:{brandId:d}})}function oe(d){return c({url:"/mall4cloud_product/platform/brand",method:"post",data:d})}function le(d){return c({url:"/mall4cloud_product/platform/brand",method:"put",data:d})}function ye(d){return c({url:"/mall4cloud_product/platform/brand",method:"delete",params:{brandId:d}})}function he(d){return c({url:"/mall4cloud_product/platform/brand/update_brand_status",method:"put",data:d})}const se={class:"dialog-footer"},ne={__name:"add-or-update",emits:["refreshDataList"],setup(d,{expose:v,emit:N}){const S=N,t=X({visible:!1,dataForm:{brandId:0,name:null,desc:null,imgUrl:null,firstLetter:null,categoryIds:[],seq:null},selectedCategories:[],categorySelectorVisible:!1,rules:{name:[{required:!0,message:"品牌名称不能为空",trigger:"blur"}],imgUrl:[{required:!0,message:"logo图片不能为空",trigger:"blur"}],firstLetter:[{required:!0,message:"首字母不能为空",trigger:"blur"},{pattern:/^[A-Z]$/,message:"首字母必须为大写英文字母",trigger:"blur"}]}}),{visible:p,dataForm:m,selectedCategories:U,categorySelectorVisible:q,rules:$}=Y(t),g=y(),L=a=>{t.dataForm.brandId=a||0,t.visible=!0,V(()=>{g.value.resetFields(),t.dataForm.brandId&&re(a).then(e=>{t.dataForm=e,O(e.categories)})})},O=a=>{if(a.length){let e={};const u=[];let r=[];a.forEach((s,b)=>{u.push(s.categoryId),s.pathNames&&s.pathNames.length&&(s.pathNames[0]&&r.push(s.pathNames[0]),s.pathNames[1]&&r.push(s.pathNames[1])),s.name&&r.push(s.name),e.firstCategoryName=r[0],e.secondCategoryName=r[1],e.threeCategoryName=r[2],t.selectedCategories.push(e),r=[],e={}}),t.dataForm.categoryIds=u}},f=y(),k=()=>{t.categorySelectorVisible=!0,V(()=>{f.value.init()})},w=(a,e)=>{t.categorySelectorVisible=!1;const u={};u.firstCategoryName=a[0],u.secondCategoryName=a[1],u.threeCategoryName=a[2],t.selectedCategories.length&&t.dataForm.categoryIds.forEach((r,s)=>{r===e&&(t.selectedCategories.splice(s,1),t.dataForm.categoryIds.splice(s,1))}),t.dataForm.categoryIds.push(e),t.selectedCategories.push(u)},D=a=>{t.selectedCategories.splice(a,1),t.dataForm.categoryIds.splice(a,1)},E=()=>{t.dataForm={brandId:0,name:null,desc:null,imgUrl:null,firstLetter:null,categoryIds:[],seq:null},t.selectedCategories=[]},R=()=>{g.value.validate(a=>{if(!a)return;const e={brandId:t.dataForm.brandId,name:t.dataForm.name,desc:t.dataForm.desc,imgUrl:t.dataForm.imgUrl,firstLetter:t.dataForm.firstLetter,categoryIds:t.dataForm.categoryIds,seq:t.dataForm.seq||0};(t.dataForm.brandId?le(e):oe(e)).then(()=>{x({message:W("table.actionSuccess"),type:"success",duration:1500,onClose:()=>{t.visible=!1,S("refreshDataList"),g.value.resetFields()}})})})};return v({init:L}),(a,e)=>{const u=G,r=P,s=Q,b=K,B=z,j=A,_=H,M=J,T=Z;return h(),F(T,{modelValue:o(p),"onUpdate:modelValue":e[7]||(e[7]=n=>ee(p)?p.value=n:null),title:o(m).brandId?a.$t("table.edit"):a.$t("table.create"),"close-on-click-modal":!1,class:"component-brand-add-or-update",width:"800px",onClose:E},{footer:i(()=>[te("div",se,[l(_,{onClick:e[5]||(e[5]=n=>p.value=!1)},{default:i(()=>[C(I(a.$t("table.cancel")),1)]),_:1}),l(_,{type:"primary",onClick:e[6]||(e[6]=n=>R())},{default:i(()=>[C(I(a.$t("table.confirm")),1)]),_:1})])]),default:i(()=>[l(j,{ref_key:"dataFormRef",ref:g,rules:o($),model:o(m),"label-width":"100px",style:{width:"620px","margin-left":"50px"}},{default:i(()=>[l(r,{label:a.$t("product.brand.name"),prop:"name"},{default:i(()=>[l(u,{modelValue:o(m).name,"onUpdate:modelValue":e[0]||(e[0]=n=>o(m).name=n),placeholder:"请输入品牌名称"},null,8,["modelValue"])]),_:1},8,["label"]),l(r,{label:a.$t("product.brand.desc"),prop:"desc"},{default:i(()=>[l(u,{modelValue:o(m).desc,"onUpdate:modelValue":e[1]||(e[1]=n=>o(m).desc=n),type:"textarea",rows:2,maxlength:"30","show-word-limit":"",placeholder:"请输入品牌描述"},null,8,["modelValue"])]),_:1},8,["label"]),l(r,{label:a.$t("product.brand.imgUrl"),prop:"imgUrl"},{default:i(()=>[l(s,{modelValue:o(m).imgUrl,"onUpdate:modelValue":e[2]||(e[2]=n=>o(m).imgUrl=n)},null,8,["modelValue"])]),_:1},8,["label"]),l(r,{label:a.$t("product.brand.firstLetter"),prop:"firstLetter"},{default:i(()=>[l(u,{modelValue:o(m).firstLetter,"onUpdate:modelValue":e[3]||(e[3]=n=>o(m).firstLetter=n),maxlength:"1",placeholder:"请输入首字母"},null,8,["modelValue"])]),_:1},8,["label"]),l(r,{label:a.$t("product.category.categoryParent")},{default:i(()=>[l(b,{"selected-categories":o(U),multiple:!0,onSelectOrReviseCategory:k,onDeleteCategoryItemOfSelected:D},null,8,["selected-categories"])]),_:1},8,["label"]),l(r,{label:a.$t("product.brand.seq"),prop:"seq"},{default:i(()=>[l(B,{modelValue:o(m).seq,"onUpdate:modelValue":e[4]||(e[4]=n=>o(m).seq=n),"controls-position":"right",precision:0,min:0},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["rules","model"]),o(q)?(h(),F(M,{key:0,ref_key:"categorySelectorRef",ref:f,onGetCategorySelected:w},null,512)):ae("",!0)]),_:1},8,["modelValue","title"])}}},Fe=Object.freeze(Object.defineProperty({__proto__:null,default:ne},Symbol.toStringTag,{value:"Module"}));export{ne as _,Fe as a,ye as d,he as e,_e as p};
