var B=Object.defineProperty;var E=Object.getOwnPropertySymbols;var w=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable;var I=(p,i,s)=>i in p?B(p,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):p[i]=s,L=(p,i)=>{for(var s in i||(i={}))w.call(i,s)&&I(p,s,i[s]);if(E)for(var s of E(i))G.call(i,s)&&I(p,s,i[s]);return p};import{a as N,q as H,r as K,H as j,D as x,F as O,p as X,s as z,G as A}from"./element-plus@2.9.10_vue@3.5.14-e58ff881.js";import{a as J}from"./@vue_runtime-dom@3.5.14-7e661aa4.js";import{m as Q,t as W,h as Y,c as Z,j as ee,k as te}from"./index-6f2da097.js";import{$ as oe}from"./_t-d5227884.js";import{q as re,D as ae,b as me,y as r,a as P}from"./@vue_reactivity@3.5.14-2213b677.js";import{o as h,H as ie,I as l,a as $,i as a,M as _,c as se,F as le,X as ne,n as ue}from"./@vue_runtime-core@3.5.14-81aa8ddd.js";import{U as F}from"./@vue_shared@3.5.14-94c2c668.js";import"./@vue-06e0889c.js";import"./lodash-es@4.17.21-e2bba480.js";import"./@vueuse_shared@9.13.0_vue@3.5.14-f0e16060.js";import"./@vueuse_core@9.13.0_vue@3.5.14-f98106e7.js";import"./@element-plus_icons-vue@2.3.1_vue@3.5.14-71698097.js";import"./@sxzz_popperjs-es@2.11.7-7c8154ca.js";import"./@ctrl_tinycolor@3.6.1-86a38320.js";import"./dayjs@1.11.13-c188735a.js";import"./@intlify_core-base@9.2.2-93f07292.js";import"./@intlify_message-compiler@9.2.2-228be59b.js";import"./@intlify_shared@9.2.2-29bf9385.js";import"./source-map@0.6.1-02de534d.js";import"./@intlify_devtools-if@9.2.2-22850edc.js";import"./async-validator@4.2.5-774c2804.js";import"./memoize-one@6.0.0-297ddbcb.js";import"./normalize-wheel-es@1.2.0-ed76fb12.js";import"./@floating-ui_dom@1.7.0-586b25a4.js";import"./@floating-ui_core@1.7.0-7ff28a0e.js";import"./@floating-ui_utils@0.2.9-746d277c.js";import"./pinia@2.3.1_vue@3.5.14-4833dba6.js";import"./vue-demi@0.14.10_vue@3.5.14-71ba0ef2.js";import"./vue-router@4.5.1_vue@3.5.14-0f6ed4bc.js";import"./vue-i18n@9.2.2_vue@3.5.14-cf205787.js";import"./vue@3.5.14-dfc94670.js";import"./vue-cookies@1.8.3-f66fc855.js";import"./@element-plus_icons-vue@2.1.0_vue@3.5.14-0cb2d1d1.js";import"./axios@1.4.0-e76ab20a.js";import"./qs@6.11.2-13302ec8.js";import"./side-channel@1.1.0-f5737a48.js";import"./es-errors@1.3.0-c75f5a96.js";import"./object-inspect@1.13.4-95f40997.js";import"./crypto-js@4.1.1-4a4e7433.js";import"./side-channel-list@1.0.0-2bff8a80.js";import"./side-channel-map@1.0.1-ef12932d.js";import"./get-intrinsic@1.3.0-829e561c.js";import"./es-object-atoms@1.1.1-11ea1ab9.js";import"./math-intrinsics@1.1.0-9389030e.js";import"./gopd@1.2.0-f4eec54c.js";import"./es-define-property@1.0.1-88d30046.js";import"./has-symbols@1.1.0-1e41ff1e.js";import"./get-proto@1.0.1-a9f527cc.js";import"./dunder-proto@1.0.1-62f72dc7.js";import"./call-bind-apply-helpers@1.0.2-03b6ca7f.js";import"./function-bind@1.1.2-48f717dc.js";import"./hasown@2.0.2-f810df7c.js";import"./call-bound@1.0.4-15e4d619.js";import"./side-channel-weakmap@1.0.2-460ea971.js";import"./big.js@6.2.1-49ab783c.js";import"./dompurify@3.0.3-4985f3f0.js";import"./moment@2.29.4-4717c495.js";const pe={class:"up-wrapper"},de={class:"dialog-footer"},_t={__name:"add-or-update",emits:["refreshDataList"],setup(p,{expose:i,emit:s}){const k=s,t=re({visible:!1,dataForm:{menuPermissionId:0,menuId:null,permission:null,name:"",uri:"",method:1},dataRule:{name:[{required:!0,message:"资源名称不能为空",trigger:"blur"}],menuId:[{required:!0,message:"上级菜单不能为空",trigger:"blur"}],method:[{required:!0,message:"请求方法不能为空",trigger:"blur"}],uri:[{required:!0,message:"资源路径不能为空",trigger:"blur"}],permission:[{required:!0,message:"授权标识不能为空",trigger:"blur"}]},menuList:[],selectedMenu:[],menuListTreeProps:{value:"id",label:"title"}}),{visible:f,dataForm:n,dataRule:q,menuList:y,selectedMenu:g,menuListTreeProps:D}=ae(t),c=me(),M=m=>{t.dataForm.menuPermissionId=m||0,t.visible=!0,ue(()=>{c.value.resetFields(),Q(L({},t.searchParam)).then(e=>{e.forEach(u=>{u.title=u.meta.title}),t.menuList=W(e),t.pageLoading=!1}),t.dataForm.menuPermissionId?Y(m).then(e=>{t.dataForm=e;const u=Z(t.menuList,e.menuId).reverse(),d=[];u.forEach(b=>{d.push(b.id)}),t.selectedMenu=d}):t.selectedMenu=[]})},T=m=>{t.dataForm.menuId=m[m.length-1]},V=()=>{c.value.validate(m=>{if(m){const e={menuPermissionId:t.dataForm.menuPermissionId||void 0,menuId:t.dataForm.menuId||void 0,name:t.dataForm.name,permission:t.dataForm.permission,uri:t.dataForm.uri,method:t.dataForm.method};(t.dataForm.menuPermissionId?ee(e):te(e)).then(()=>{N({message:oe("table.actionSuccess"),type:"success",duration:1500,onClose:()=>{t.visible=!1,k("refreshDataList"),c.value.resetFields()}})})}})};return i({init:M}),(m,e)=>{const u=H,d=K,b=j,R=x,U=O,C=X,v=z,S=A;return h(),ie(S,{modelValue:r(f),"onUpdate:modelValue":e[8]||(e[8]=o=>P(f)?f.value=o:null),class:"component-menu-permission-add-or-update",title:r(n).menuPermissionId?m.$t("table.edit"):m.$t("table.create")},{footer:l(()=>[$("div",de,[a(v,{onClick:e[6]||(e[6]=o=>f.value=!1)},{default:l(()=>[_(F(m.$t("table.cancel")),1)]),_:1}),a(v,{type:"primary",onClick:e[7]||(e[7]=o=>V())},{default:l(()=>[_(F(m.$t("table.confirm")),1)]),_:1})])]),default:l(()=>[$("div",pe,[a(C,{ref_key:"dataFormRef",ref:c,model:r(n),rules:r(q),"label-width":"80px",onKeyup:e[5]||(e[5]=J(o=>V(),["enter"]))},{default:l(()=>[a(d,{label:m.$t("rbac.menuPermission.name"),prop:"name"},{default:l(()=>[a(u,{modelValue:r(n).name,"onUpdate:modelValue":e[0]||(e[0]=o=>r(n).name=o)},null,8,["modelValue"])]),_:1},8,["label"]),a(d,{label:"上级菜单",prop:"menuId"},{default:l(()=>[a(b,{modelValue:r(g),"onUpdate:modelValue":e[1]||(e[1]=o=>P(g)?g.value=o:null),"expand-trigger":"hover",options:r(y),props:r(D),"change-on-select":"",onChange:T},null,8,["modelValue","options","props"])]),_:1}),a(d,{label:"请求方法",prop:"method"},{default:l(()=>[a(U,{modelValue:r(n).method,"onUpdate:modelValue":e[2]||(e[2]=o=>r(n).method=o)},{default:l(()=>[(h(),se(le,null,ne(4,o=>a(R,{key:o,label:o},{default:l(()=>[_(F(["","GET","POST","PUT","DELETE"][o]),1)]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])]),_:1}),a(d,{label:"资源路径",prop:"uri"},{default:l(()=>[a(u,{modelValue:r(n).uri,"onUpdate:modelValue":e[3]||(e[3]=o=>r(n).uri=o)},null,8,["modelValue"])]),_:1}),a(d,{label:"授权标识",prop:"permission"},{default:l(()=>[a(u,{modelValue:r(n).permission,"onUpdate:modelValue":e[4]||(e[4]=o=>r(n).permission=o)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])])]),_:1},8,["modelValue","title"])}}};export{_t as default};
