import{L as Ce,v as oe,w as le,q as re,y as W,M as we,a as ne,x as Fe,A as xe,r as Ue,N as Ae,p as Te,G as De}from"./element-plus@2.9.10_vue@3.5.14-e58ff881.js";import{_ as j,s as ie,f as te,d as Pe,t as Ne,c as Ee}from"./index-6f2da097.js";import{a1 as $e,o as c,c as y,i as v,I as b,J as Be,a,F as B,X as M,L as P,H as $,z as ue,x as R,w as L,M as O,C as Le,V as Oe,n as ae}from"./@vue_runtime-core@3.5.14-81aa8ddd.js";import{U as E}from"./@vue_shared@3.5.14-94c2c668.js";import{_ as Me}from"./index-e4ea1e4c.js";import{B as Re}from"./big.js@6.2.1-49ab783c.js";import{c as qe}from"./category-2962f30d.js";import{q as J,D as H,y as l,a as Q,b as se}from"./@vue_reactivity@3.5.14-2213b677.js";import{u as Ge}from"./vue-router@4.5.1_vue@3.5.14-0f6ed4bc.js";import"./@vue-06e0889c.js";import"./lodash-es@4.17.21-e2bba480.js";import"./@vueuse_shared@9.13.0_vue@3.5.14-f0e16060.js";import"./@vueuse_core@9.13.0_vue@3.5.14-f98106e7.js";import"./@vue_runtime-dom@3.5.14-7e661aa4.js";import"./@element-plus_icons-vue@2.3.1_vue@3.5.14-71698097.js";import"./@sxzz_popperjs-es@2.11.7-7c8154ca.js";import"./@ctrl_tinycolor@3.6.1-86a38320.js";import"./dayjs@1.11.13-c188735a.js";import"./@intlify_core-base@9.2.2-93f07292.js";import"./@intlify_message-compiler@9.2.2-228be59b.js";import"./@intlify_shared@9.2.2-29bf9385.js";import"./source-map@0.6.1-02de534d.js";import"./@intlify_devtools-if@9.2.2-22850edc.js";import"./async-validator@4.2.5-774c2804.js";import"./memoize-one@6.0.0-297ddbcb.js";import"./normalize-wheel-es@1.2.0-ed76fb12.js";import"./@floating-ui_dom@1.7.0-586b25a4.js";import"./@floating-ui_core@1.7.0-7ff28a0e.js";import"./@floating-ui_utils@0.2.9-746d277c.js";import"./pinia@2.3.1_vue@3.5.14-4833dba6.js";import"./vue-demi@0.14.10_vue@3.5.14-71ba0ef2.js";import"./vue-i18n@9.2.2_vue@3.5.14-cf205787.js";import"./vue@3.5.14-dfc94670.js";import"./vue-cookies@1.8.3-f66fc855.js";import"./@element-plus_icons-vue@2.1.0_vue@3.5.14-0cb2d1d1.js";import"./axios@1.4.0-e76ab20a.js";import"./qs@6.11.2-13302ec8.js";import"./side-channel@1.1.0-f5737a48.js";import"./es-errors@1.3.0-c75f5a96.js";import"./object-inspect@1.13.4-95f40997.js";import"./crypto-js@4.1.1-4a4e7433.js";import"./side-channel-list@1.0.0-2bff8a80.js";import"./side-channel-map@1.0.1-ef12932d.js";import"./get-intrinsic@1.3.0-829e561c.js";import"./es-object-atoms@1.1.1-11ea1ab9.js";import"./math-intrinsics@1.1.0-9389030e.js";import"./gopd@1.2.0-f4eec54c.js";import"./es-define-property@1.0.1-88d30046.js";import"./has-symbols@1.1.0-1e41ff1e.js";import"./get-proto@1.0.1-a9f527cc.js";import"./dunder-proto@1.0.1-62f72dc7.js";import"./call-bind-apply-helpers@1.0.2-03b6ca7f.js";import"./function-bind@1.1.2-48f717dc.js";import"./hasown@2.0.2-f810df7c.js";import"./call-bound@1.0.4-15e4d619.js";import"./side-channel-weakmap@1.0.2-460ea971.js";import"./dompurify@3.0.3-4985f3f0.js";import"./moment@2.29.4-4717c495.js";const je={class:"prod-details"},Je={class:"det"},He={__name:"index",props:{detail:{type:String,default(){return""}},dataForm:{type:Object,default(){return{}}}},setup(V){return(N,_)=>{const t=Ce,s=$e("rich");return c(),y("div",je,[v(t,{type:"card"},{default:b(()=>[Be(a("div",Je,null,512),[[s,V.detail]])]),_:1})])}}},ze=j(He,[["__scopeId","data-v-7b837ba9"]]);const Xe={class:"component-spu-catagory-attrs"},Qe={class:"part-section"},We={class:"flx"},Ye={class:"sec-tit"},Ze={key:0,class:"stars-icon"},Ke={class:"name"},et={__name:"index",props:{attrsList:{type:Array,default(){return[]}}},emits:["getValueOfBasicAttrs"],setup(V,{emit:N}){const _=N,t=(s,w)=>{_("getValueOfBasicAttrs",s,w)};return(s,w)=>{const u=oe,F=le,U=re;return c(),y("div",Xe,[a("div",Qe,[(c(!0),y(B,null,M(V.attrsList,(m,T)=>(c(),y("div",{key:T,class:"part-sec-item"},[a("div",We,[a("div",Ye,[m.searchType==1?(c(),y("span",Ze)):P("",!0),a("span",Ke,E(m.name),1)]),m.attrValues.length?(c(),$(F,{key:0,modelValue:m.attrValue,"onUpdate:modelValue":n=>m.attrValue=n,placeholder:"请选择",style:{width:"230px"},onChange:n=>t(m,0)},{default:b(()=>[(c(!0),y(B,null,M(m.attrValues,n=>(c(),$(u,{key:n.attrValueId,disabled:"",label:n.value,value:n.attrValueId},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])):(c(),$(U,{key:1,modelValue:m.attrValue,"onUpdate:modelValue":n=>m.attrValue=n,readonly:!0,style:{width:"230px"},onBlur:n=>t(m,1)},null,8,["modelValue","onUpdate:modelValue","onBlur"]))])]))),128))])])}}},tt=j(et,[["__scopeId","data-v-12ac259f"]]);function at(V){return ie({url:"/mall4cloud_product/admin/spu",method:"get",params:{spuId:V}})}function st(V){return ie({url:"/mall4cloud_product/admin/attr/get_attrs_by_category_id",method:"get",params:V})}const ot={class:"component-sku-container"},lt={class:"spec-name"},rt={key:0,class:"spec-imgbox"},nt=["src"],it=["onClick"],ut={__name:"index",props:{sku:{type:Object,default(){return{}}},hasSkuImage:{type:Boolean,default:!1},onSkuLeafChange:{type:Function,default:()=>{}}},emits:["update:sku"],setup(V,{emit:N}){const _=ue("ease"),t=N,s=V,w=J({resourcesUrl:"http://192.168.1.80:9000/mall4cloud",visiable:!1,skuOptions:[],id:0}),{resourcesUrl:u}=H(w),F=R({get(){return F.value},set(o){t("update:sku",o)}}),U=R(()=>_.optionValue),m=R(()=>_.optionText);L(()=>F.value,o=>{T(o[U.value])});const T=o=>{o&&_.onFetchSku(o).then(g=>{w.id=o,w.skuOptions=g})},n=o=>{F.value.leaf.splice(o,1),s.onSkuLeafChange(F.value.leaf)},I=o=>{_.onPreviewImg(o)};return(o,g)=>{const x=W;return c(),y("div",ot,[a("div",lt,[(c(!0),y(B,null,M(V.sku.leaf,(f,D)=>(c(),y("div",{key:D,class:"spec-name-int"},[v(x,{type:f.type,effect:"plain",onClose:S=>n(D)},{default:b(()=>[O(E(f[m.value]),1)]),_:2},1032,["type","onClose"]),f.imgUrl?(c(),y("div",rt,[V.hasSkuImage?(c(),y("img",{key:0,src:f.imgUrl.indexOf("http")===-1?l(u)+f.imgUrl:f.imgUrl,class:"spec-img"},null,8,nt)):P("",!0),a("div",{class:"preview-btn",onClick:S=>I(f.imgUrl)}," 预览 ",8,it)])):P("",!0)]))),128))])])}}},dt=j(ut,[["__scopeId","data-v-5373c11f"]]);const ct={class:"component-sku-group"},pt={class:"spec-box"},mt={class:"spec-select"},ft={class:"sel-box"},_t={key:0,class:"sel-add-img"},gt={__name:"index",props:{index:{type:Number,default:0},sku:{type:Object,default(){return{}}},optionValue:{type:String,default:"id"},optionText:{type:String,default:"text"},onSkuChange:{type:Function,default:()=>{}},onSkuRemove:{type:Function,default:()=>{}}},emits:["update:sku"],setup(V,{emit:N}){const _=ue("ease"),t=N,s=V,w=J({skuValue:"",newsSkuText:"",hasSkuImage:s.sku.leaf?s.sku.leaf.some(o=>o.imgUrl):!1}),{skuValue:u,hasSkuImage:F}=H(w),U=R({get(){return s.sku},set(o){t("update:sku",o)}}),m=o=>{if(typeof o=="number"){const g=_.skuTreeData.find(x=>x[s.optionValue]===o);g.leaf=[],s.onSkuChange(g,s.index)===!1&&(w.skuValue="");return}T(o)},T=o=>{_.onCreateGroup(o).then(g=>{g>0&&(U.value={[s.optionValue]:g,[s.optionText]:o,leaf:[]},s.onSkuChange(s.sku,s.index))})},n=o=>{U.value.leaf=s.sku.leaf.map(g=>(g.is_show=o,g)),s.onSkuChange(s.sku,s.index)},I=o=>{U.value.leaf=o,this.onSkuChange(s.sku,s.index)};return(o,g)=>{const x=oe,f=le,D=we;return c(),y("div",ct,[a("div",pt,[a("div",mt,[a("div",ft,[v(f,{modelValue:l(u),"onUpdate:modelValue":g[0]||(g[0]=S=>Q(u)?u.value=S:null),placeholder:"请选择","allow-create":"",filterable:"","filter-method":o.filterMethod,style:{"min-width":"100px"},disabled:"",onChange:m},{default:b(()=>[(c(!0),y(B,null,M(l(_).skuTreeData,S=>(c(),$(x,{key:S[V.optionValue],label:S[V.optionText],value:S[V.optionValue]},null,8,["label","value"]))),128))]),_:1},8,["modelValue","filter-method"])]),V.index===0&&l(_).showAddSkuImage?(c(),y("div",_t,[v(D,{modelValue:l(F),"onUpdate:modelValue":g[1]||(g[1]=S=>Q(F)?F.value=S:null),disabled:!0,onChange:n},{default:b(()=>g[3]||(g[3]=[O(" 添加属性图片 ")])),_:1,__:[3]},8,["modelValue"])])):P("",!0)])]),v(dt,{sku:U.value,"onUpdate:sku":g[2]||(g[2]=S=>U.value=S),"has-sku-image":l(F),"on-sku-leaf-change":I},null,8,["sku","has-sku-image"])])}}},kt=j(gt,[["__scopeId","data-v-2fd05f72"]]),ht={class:"component-sku-block"},vt={__name:"index",props:{hasSkuImg:{type:Boolean,default:!1},salesAttrs:{type:Array,default(){return[]}},skuTree:{type:Array,default(){return[]}},sku:{type:Object,default(){return{}}},categoryId:{type:Number,default:null},optionValue:{type:String,default:"id"},onFetchGroup:{type:Function,default:()=>{}}},emits:["update:modelValue","on-change"],setup(V,{emit:N}){const _=V;Le("ease",_);const t=N,s=J({data:_.salesAttrs,skuTreeData:_.skuTree,warning:!1}),{data:w,skuTreeData:u}=H(s);L(()=>s.data,m=>{t("update:modelValue",m)}),L(()=>_.skuTree,m=>{s.skuTreeData=m}),L(()=>_.categoryId,()=>{_.categoryId||s.data.splice(0,s.data.length)});const F=(m,T)=>{if(s.data.some((n,I)=>n[_.optionValue]===m[_.optionValue]&&T!==I))return ne({message:"规格名不能重复",duration:800}),!1;s.data[T]=Object.assign({},m),s.skuTreeData.some(n=>n[_.optionValue]===m[_.optionValue])||s.skuTreeData.push(m),t("on-change",s.data)},U=m=>{s.data.splice(m,1),t("on-change",s.data)};return Oe(()=>{typeof _.onFetchGroup=="function"&&_.onFetchGroup().then(m=>{s.skuTreeData=m})}),(m,T)=>(c(),y("div",ht,[(c(!0),y(B,null,M(l(w),(n,I)=>(c(),$(kt,{key:I,sku:l(w)[n],"onUpdate:sku":o=>l(w)[n]=o,index:I,"sku-tree":l(u),"on-sku-change":F,"on-sku-remove":U},null,8,["sku","onUpdate:sku","index","sku-tree"]))),128))]))}};const yt={class:"component-sku-table"},Vt={__name:"index",props:{data:{type:Array,default(){return[]}},flatten:{type:Array,default(){return[]}},optionValue:{type:String,default:"id"},optionText:{type:String,default:"text"},spuId:{type:Number,default:null},isNoSkuValue:{type:Boolean,default:!1}},emits:["on-change-data"],setup(V,{emit:N}){const _=N,t=V,s=J({rowspan:[],lists:[],originList:[],firstSkuVal:-1,secondSkuVal:-1,stockIntVal:"",markedPriceIntVal:"",priceIntVal:"",barCodeIntVal:"",skuCodeIntVal:""}),{lists:w}=H(s),u=R(()=>t.data.filter(n=>n.text&&n.leaf.length)),F=R(()=>u.value.map(n=>n[t.optionText])),U=(n,I)=>{const o={stock:0,marketPriceFee:"",priceFee:.01,partyCode:"",modelId:""};return n.length&&te(n,I).length?te(n,I,{extraData:o}):[o]},m=()=>{s.rowspan=[];const n=I=>{const o=[];let g=0;s.lists.forEach((x,f)=>{var D,S;f===0?o.push(1):((D=x.spuSkuAttrValues)==null?void 0:D[I].attrValueName)===((S=s.lists[f-1].spuSkuAttrValues)==null?void 0:S[I].attrValueName)?(o[g]+=1,o.push(0)):(g=f,o.push(1))}),s.rowspan.push(o)};u.value.forEach((I,o)=>{n(o)})};L(u.value,()=>{const n=U(u.value,t.flatten);s.lists=n,m()},{deep:!0,immediate:!0}),L(t.flatten,()=>{s.originList=JSON.parse(JSON.stringify(U(u.value,t.flatten))),s.lists.length===1&&!s.lists[0].spuSkuAttrValues&&t.flatten.forEach(n=>{const I={stock:n.stock,marketPriceFee:n.marketPriceFee,priceFee:n.priceFee,partyCode:n.partyCode,modelId:n.modelId};s.lists=[I]})}),L(()=>s.lists,n=>{_("on-change-data",n)},{deep:!0,immediate:!0});const T=({row:n,column:I,rowIndex:o,columnIndex:g})=>{for(let x=0;x<u.value.length;x++)if(g===x)return s.rowspan[x]&&s.rowspan[x][o]?{rowspan:s.rowspan[x][o],colspan:1}:{rowspan:0,colspan:0}};return(n,I)=>{const o=Fe,g=W,x=xe;return c(),y("div",yt,[v(x,{border:"",data:l(w),"span-method":T,class:"tab-con"},{default:b(()=>[(c(!0),y(B,null,M(F.value,(f,D)=>(c(),y(B,null,[f?(c(),$(o,{key:D,label:f},{default:b(S=>[O(E(S.row.spuSkuAttrValues[D]&&S.row.spuSkuAttrValues[D].attrValueName),1)]),_:2},1032,["label"])):P("",!0)],64))),256)),v(o,{prop:"stock",label:"库存",class:"tab-int"},{default:b(f=>[a("span",null,E(f.row.stock),1)]),_:1}),v(o,{prop:"marketPriceFee",label:"市场价(元)",class:"tab-int"},{default:b(f=>[a("span",null,E(f.row.marketPriceFee),1)]),_:1}),v(o,{prop:"priceFee",label:"销售价(元)",class:"tab-int"},{default:b(f=>[a("span",null,E(f.row.priceFee),1)]),_:1}),v(o,{prop:"barCode",label:"商品条形码",class:"tab-int"},{default:b(f=>[a("span",null,E(f.row.modelId),1)]),_:1}),v(o,{prop:"skuCode",label:"商品编码",class:"tab-int"},{default:b(f=>[a("span",null,E(f.row.partyCode),1)]),_:1}),V.spuId&&!V.isNoSkuValue?(c(),$(o,{key:0,prop:"skuCode",label:"sku状态"},{default:b(f=>[v(g,{type:f.row.status===0?"danger":""},{default:b(()=>[O(E(f.row.status===1?"启用":"禁用"),1)]),_:2},1032,["type"])]),_:1})):P("",!0)]),_:1},8,["data"])])}}};const bt={class:"mod-prod-info release-goods"},It={class:"info-box"},St={class:"part-content"},Ct={class:"part-form-div"},wt={class:"part-form-item"},Ft={class:"classify-show"},xt={class:"part-form-div"},Ut={class:"part-form-item"},At={class:"classify-show"},Tt={key:0},Dt={class:"brand"},Pt=["src"],Nt={class:"brandname"},Et={class:"part-form-div"},$t={key:0,class:"part-form-item"},Bt=["src"],Lt={class:"part-form-div"},Ot={key:0,class:"part-form-item"},Mt=["src","onClick"],Rt={class:"part-content"},qt={class:"part-form-div"},Gt={class:"part-form-item"},jt={class:"part-form-div"},Jt={class:"setup-spec"},Ht={class:"sku-table"},zt={class:"part-form-div"},Xt={class:"part-form-item-tit"},Qt={class:"part-content"},Wt={class:"part-form-info"},Yt={__name:"prod-details",setup(V,{expose:N}){const _=Ge(),t=J({visible:!1,resourcesUrl:"http://192.168.1.80:9000/mall4cloud",dataForm:{spuId:_.query.spuId||null,categoryId:null,shopCategoryId:null,name:"",sellingPoint:"",brandId:0,imgUrls:"",isCompose:0,mainImgUrl:"",hasSkuImg:0,scoreFee:0,seq:null,spuAttrValues:[],deliveryMode:{hasShopDelivery:!0,hasUserPickUp:!1,hasCityDelivery:!1},deliveryTemplateId:"",detail:"",skuList:[],totalStock:0},backTotalStock:null,brandName:"",brandImgUrl:"",basicAttrs:[],salesAttrs:[],originalSalesAttrs:[],selectedCategories:[],showCategorySelectBtn:!0,transportTemplates:[],spuAttrValueList:[],value:null,skuTree:[],sku:[],content:"",skuTableData:[],originalSkuTree:[],flatten:[],originalSpuAttrValueList:[],isNoSkuValue:!1,picturePreviewVisible:!1,detail:null}),{visible:s,resourcesUrl:w,dataForm:u,brandName:F,brandImgUrl:U,basicAttrs:m,salesAttrs:T,originalSalesAttrs:n,selectedCategories:I,showCategorySelectBtn:o,originalSkuTree:g,flatten:x,isNoSkuValue:f,picturePreviewVisible:D,detail:S}=H(t),Y=se(),de=r=>{t.visible=!0,t.dataForm.spuId=r||"",ae(()=>{var e;(e=Y.value)==null||e.resetFields(),r&&at(r).then(i=>{var p,d;t.dataForm=i,t.originalSpuAttrValueList=i.spuAttrValues,t.backTotalStock=i.skus.reduce((k,{stock:h})=>(k+=h||0,k),0),t.dataForm.imgUrls=i.imgUrls.split(","),ce(i.categoryId),t.showCategorySelectBtn=!1,(p=i.brand)!=null&&p.imgUrl&&(t.brandImgUrl=i.brand.imgUrl.indexOf("http")===-1?t.resourcesUrl+i.brand.imgUrl:i.brand.imgUrl),t.brandName=(d=i.brand)==null?void 0:d.name,pe(i.categoryId,i.spuAttrValues),fe(i.skus),t.detail=Pe(t.dataForm.detail)})})},ce=r=>{let e={};qe().then(i=>{const p=Ne(i,"categoryId","parentId");e=Ee(p,r,"categoryId").reverse(),e.forEach(d=>t.selectedCategories.push(d.name))})},pe=(r,e)=>{st({categoryId:r,attrType:1}).then(p=>{e&&p.forEach((d,k)=>{e.forEach(h=>{!d.attrValues.length&&(!h.attrValueId||h.attrValueId===0)?d.attrId===h.attrId&&(d.attrValue=h.attrValueName):d.attrValues.some(A=>h.attrValueId===A.attrValueId)&&(d.attrValue=h.attrValueId)})}),t.basicAttrs=p})},me=(r,e,i)=>{const p=t.originalSpuAttrValueList,d=t.spuAttrValueList,k={};if(t.dataForm.spuId&&p.forEach((h,A)=>{h.attrId===e.attrId&&(e.spuAttrValueId=h.spuAttrValueId,k.spuAttrValueId=e.spuAttrValueId)}),k.attrId=e.attrId,k.attrName=e.name,i===0&&e.attrValues.forEach(h=>{if(e.attrValue===h.attrValueId)return k.attrValueId=e.attrValue,k.attrValueName=h.value,d.push(k),!0}),i===1)if(k.attrValueId="",k.attrValueName=e.attrValue,e.searchType===1&&!e.attrValue){ne({message:"当前属性为必填属性，请填写属性值！",duration:1500});return}else d.push(k);Z(d,"attrId"),t.dataForm.spuAttrValues=d},fe=r=>{if(r&&r.length>0){const e=[],i=[],p=[];r.forEach(d=>{var k;(k=d.spuSkuAttrValues)==null||k.forEach((h,A)=>{if(h.attrName===null&&h.attrValueName===null){t.isNoSkuValue=!0;return}const X="random_";i[A]=i[A]||h.attrId||X+parseInt(Math.random()*100,10)+1,h.attrId=i[A],p[A]||(p[A]={});const q=p[A][h.attrValueName]||h.attrValueId||X+parseInt(Math.random()*100,10)+parseInt(Math.random()*100,10);p[A][h.attrValueName]=q,h.attrValueId=q;const G={id:q,is_show:!!d.imgUrl,text:h.attrValueName};A===0&&(G.imgUrl=d.imgUrl||""),e[A]===void 0?e[A]={id:i[A],leaf:[G],text:h.attrName}:e[A].leaf.push(G)})}),e.forEach(d=>{d.leaf=Z(d.leaf,"id")}),r.forEach(d=>{d.marketPriceFee=parseFloat(K(parseFloat(d.marketPriceFee),100)),d.priceFee=parseFloat(K(parseFloat(d.priceFee),100))}),r.forEach((d,k)=>{t.flatten[k]=d}),e.forEach((d,k)=>{t.salesAttrs[k]=d})}_e(r)},_e=r=>{r||t.originalSalesAttrs.splice(0,t.originalSalesAttrs.length),t.skuTree.splice(0,t.skuTree.length)},Z=(r,e)=>{for(let i=0;i<r.length;i++)for(let p=i+1;p<r.length;p++)r[i][e]===r[p][e]&&(r.splice(i,1),p--);return r},ge=()=>new Promise(r=>{r(t.skuTree)}),ke=r=>new Promise(e=>{e(he(r))}),he=r=>(t.sku=[],t.originalSalesAttrs.forEach(e=>{r===e.attrId&&e.attrValues.forEach(i=>{const p={};p.text=i.value,p.id=i.attrValueId,t.sku.push(p)})}),t.sku),ve=r=>new Promise((e,i)=>{r?e("random_"+parseInt(Math.random()*100,10)+1):i(new Error)}),ye=r=>new Promise((e,i)=>{const p="random_";e(r.data.map(d=>({id:p+parseInt(Math.random()*100,10)+parseInt(Math.random()*100,10),text:d,leaf:[]})))}),Ve=r=>{var e;t.skuTree=r,(e=r==null?void 0:r[0])==null||e.leaf.forEach(i=>{i.is_show?t.dataForm.hasSkuImg=1:t.dataForm.hasSkuImg=0})},be=r=>{var d;t.skuTableData=r;const e=[],i=[];let p=0;(d=t.skuTableData)==null||d.forEach((k,h)=>{k.marketPriceFee||(k.marketPriceFee=0),k.stock&&(p+=Number(k.stock)),e.push(k.priceFee),i.push(k.marketPriceFee)}),t.dataForm.skus&&t.dataForm.skus.forEach(()=>{t.dataForm.changeStock=p-t.backTotalStock}),t.dataForm.priceFee=Math.min.apply(null,e),t.dataForm.marketPriceFee=Math.min.apply(null,i),t.dataForm.totalStock=p},Ie=()=>{t.dataForm={spuId:null,categoryId:null,shopCategoryId:null,name:"",sellingPoint:"",brandId:0,imgUrls:"",isCompose:0,mainImgUrl:"",hasSkuImg:0,scoreFee:0,seq:null,spuAttrValues:[],deliveryMode:{hasShopDelivery:!0,hasUserPickUp:!1,hasCityDelivery:!1},deliveryTemplateId:"",detail:"",skuList:[],totalStock:0},t.detail=null,t.salesAttrs=[],t.basicAttrs=[],t.transportTemplates=[],t.brandName="",t.brandImgUrl="",t.selectedCategories=[]},K=(r,e)=>r==null?"":new Re(r).div(e).valueOf(),ee=se(),z=r=>{t.picturePreviewVisible=!0,ae(()=>{ee.value.init(r)})};return N({init:de}),(r,e)=>{const i=Me,p=re,d=Ue,k=W,h=tt,A=Ae,X=ze,q=Te,G=De;return c(),$(G,{modelValue:l(s),"onUpdate:modelValue":e[8]||(e[8]=C=>Q(s)?s.value=C:null),"close-on-click-modal":!1,"destroy-on-close":!0,top:"0",class:"component-prod-details",width:"1100px",title:"商品详情",onClose:Ie},{default:b(()=>[a("div",bt,[v(q,{ref_key:"dataFormRef",ref:Y,class:"part-form",model:l(u),"label-width":"110px"},{default:b(()=>[a("div",It,[a("div",St,[e[15]||(e[15]=a("div",{class:"part-tit"},[a("span",{class:"part-tit-num"},"1"),a("span",{class:"part-tit-name"},"商品基本信息")],-1)),a("div",Ct,[e[9]||(e[9]=a("div",{class:"part-form-item-tit"}," 平台分类 ",-1)),a("div",wt,[a("div",Ft,[v(i,{"selected-categories":l(I),"show-category-select-btn":l(o),single:!0,onSelectOrReviseCategory:e[0]||(e[0]=C=>r.selectOrReviseCategory("platform"))},null,8,["selected-categories","show-category-select-btn"])])])]),a("div",xt,[e[10]||(e[10]=a("div",{class:"part-form-item-tit"}," 店铺分类 ",-1)),a("div",Ut,[a("div",At,[l(u).shopCategory?(c(),y("span",Tt,E(l(u).shopCategory.pathNames[0])+" > "+E(l(u).shopCategory.name),1)):P("",!0)])])]),v(d,{label:"商品标题",prop:"name"},{default:b(()=>[v(p,{modelValue:l(u).name,"onUpdate:modelValue":e[1]||(e[1]=C=>l(u).name=C),readonly:!0,placeholder:"商品标题组成：商品描述+属性",disabled:!l(u).categoryId,style:{width:"90%"}},null,8,["modelValue","disabled"])]),_:1}),v(d,{label:"商品卖点",prop:"sellingPoint"},{default:b(()=>[v(p,{modelValue:l(u).sellingPoint,"onUpdate:modelValue":e[2]||(e[2]=C=>l(u).sellingPoint=C),readonly:!0,type:"textarea",placeholder:"商品卖点",disabled:!l(u).categoryId,style:{width:"90%"}},null,8,["modelValue","disabled"])]),_:1}),v(d,{label:"所属品牌"},{default:b(()=>[a("div",Dt,[l(U)?(c(),y("img",{key:0,src:l(U),class:"brand-img"},null,8,Pt)):P("",!0),l(F)?(c(),$(k,{key:1,class:"br","disable-transitions":!0,onClose:e[3]||(e[3]=C=>r.handleCloseBrand())},{default:b(()=>[a("span",Nt,E(l(F)),1)]),_:1})):P("",!0)])]),_:1}),l(m).length>0?(c(),$(d,{key:0,label:"基本属性"},{default:b(()=>[e[11]||(e[11]=a("div",{class:"text"},[O(" 请准确填写属性，有利于商品在搜索和推荐中露出，错误填写可能面临商品下架或流量损失！（注：带"),a("span",{class:"stars-icon"}),O("为重要属性，必填） ")],-1)),v(h,{"attrs-list":l(m),onGetValueOfBasicAttrs:me},null,8,["attrs-list"])]),_:1,__:[11]})):P("",!0),v(d,{label:"商品排序"},{default:b(()=>[v(p,{modelValue:l(u).seq,"onUpdate:modelValue":e[4]||(e[4]=C=>l(u).seq=C),modelModifiers:{number:!0},readonly:!0,max:32767,oninput:"value=value.replace(/^\\.+|[^\\d.]/g,'')",placeholder:"请输入商品排序",min:1,"validate-event":"",style:{width:"200px"}},null,8,["modelValue"])]),_:1}),a("div",Et,[e[12]||(e[12]=a("div",{class:"part-form-item-tit"}," 商品主图 ",-1)),l(u).mainImgUrl?(c(),y("div",$t,[a("img",{src:l(u).mainImgUrl.indexOf("http")===-1?l(w)+l(u).mainImgUrl:l(u).mainImgUrl,class:"main-img",onClick:e[5]||(e[5]=C=>z(l(u).mainImgUrl))},null,8,Bt)])):P("",!0)]),a("div",Lt,[e[14]||(e[14]=a("div",{class:"part-form-item-tit"}," 商品轮播图 ",-1)),l(u).imgUrls?(c(),y("div",Ot,[(c(!0),y(B,null,M(l(u).imgUrls,(C,Se)=>(c(),y("div",{key:Se,class:"imgs"},[a("img",{src:C.indexOf("http")===-1?l(w)+C:C,class:"main-img",onClick:Zt=>z(C)},null,8,Mt)]))),128)),e[13]||(e[13]=a("div",{class:"banner-tips"}," 建议图片尺寸为 800*800，可拖动排序，最多上传9张 ",-1))])):P("",!0)])]),a("div",Rt,[e[21]||(e[21]=a("div",{class:"part-tit"},[a("span",{class:"part-tit-num"},"2"),a("span",{class:"part-tit-name"},"商品销售属性与库存")],-1)),a("div",qt,[e[16]||(e[16]=a("div",{class:"part-form-item-tit"}," 销售属性 ",-1)),a("div",Gt,[v(vt,{modelValue:l(T),"onUpdate:modelValue":e[6]||(e[6]=C=>Q(T)?T.value=C:null),"save-sales-attrs":l(n),"sku-tree":l(g),"on-fetch-group":ge,"on-fetch-sku":ke,"on-create-sku":ye,"on-create-group":ve,"on-preview-img":z,"category-id":l(u).shopCategoryId,onOnChange:Ve},null,8,["modelValue","save-sales-attrs","sku-tree","category-id"])])]),a("div",jt,[e[18]||(e[18]=a("div",{class:"part-form-item-tit"}," 价格及库存 ",-1)),a("div",Jt,[e[17]||(e[17]=a("div",{class:"imp-tips"}," 请如实填写库存信息，以确保商品可以在承诺发货时间内发出，避免可能的物流违规 ",-1)),a("div",Ht,[v(Vt,{data:l(T),flatten:l(x),"is-no-sku-value":l(f),"spu-id":parseInt(l(u).spuId),"is-category-id":!!l(u).categoryId,onOnChangeData:be},null,8,["data","flatten","is-no-sku-value","spu-id","is-category-id"])])])]),a("div",zt,[a("div",Xt,[e[20]||(e[20]=O(" 总库存 ")),v(A,{class:"item",effect:"light",content:"每个属性库存的总和",placement:"top"},{default:b(()=>e[19]||(e[19]=[a("i",{class:"el-icon-question"},null,-1)])),_:1,__:[19]})]),v(p,{modelValue:l(u).totalStock,"onUpdate:modelValue":e[7]||(e[7]=C=>l(u).totalStock=C),readonly:!0,style:{width:"150px"}},null,8,["modelValue"])])]),a("div",Qt,[e[22]||(e[22]=a("div",{class:"part-tit"},[a("span",{class:"part-tit-num"},"3"),a("span",{class:"part-tit-name"},"商品详情")],-1)),a("div",Wt,[v(X,{"data-form":l(u),detail:l(S)},null,8,["data-form","detail"])])])]),l(D)?(c(),$(z,{key:0,ref_key:"picturePreviewRef",ref:ee},null,512)):P("",!0)]),_:1},8,["model"])])]),_:1},8,["modelValue"])}}},ss=j(Yt,[["__scopeId","data-v-468b7d1b"]]);export{ss as default};
